<!DOCTYPE html>
<html lang="it">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profilo</title>
    <link rel="stylesheet" type="text/css" href="style_profile.css">
    <link rel="stylesheet" type="text/css" href="../home/style_home.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

    <!-- Firebase Configuration -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
        import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";
        import { getAuth } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js";

        // Configurazione di Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyB2qNYCMQMjm6pAqTEWvP-1FWfPfKaQCi8",
            authDomain: "kalitrack.firebaseapp.com",
            projectId: "kalitrack",
            storageBucket: "kalitrack.appspot.com",
            messagingSenderId: "253824979149",
            appId: "1:253824979149:web:21f3085e86bb3a41821984",
            measurementId: "G-498X9RNHLC"
        };

        // Inizializza Firebase
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        // Inizializza Firebase Auth
        const auth = getAuth();

        // Ottieni l'ID dell'utente attualmente autenticato
        const user = auth.currentUser;


        // Funzione per caricare le informazioni del profilo
        async function loadProfile(userId) {
            const userDoc = doc(db, "userProfiles", userId);
            const docSnapshot = await getDoc(userDoc);

            if (docSnapshot.exists()) {
                const userData = docSnapshot.data();
                document.getElementById("name").innerText = userData.name || "Non disponibile";
                document.getElementById("email").innerText = userData.email || "Non disponibile";
                document.getElementById("eta").innerText = userData.eta || "Non disponibile";
                document.getElementById("sesso").innerText = userData.sesso || "Non disponibile";
                document.getElementById("peso").innerText = userData.peso || "Non disponibile";
            } else {
                console.log("Nessun documento trovato!");
            }
        }
        const userId = "";
        if (user) {
            userId = user.uid; // user.uid contiene l'ID dell'utente
            console.log("User ID:", userId);
        } else {
            console.log("Nessun utente autenticato.");
        }

        // Funzione per gestire il caricamento del profilo quando la pagina è pronta
        document.addEventListener("DOMContentLoaded", loadProfile(userId));
    </script>
</head>

<body>
    <!-- Header -->
    <header>
        <button class="menu-btn" id="menuButton" onclick="toggleSidebar()">
            <i class="fas fa-bars"></i>
        </button>
        <div class="logo">Profilo</div>
    </header>

    <div class="dashboard-container">
        <!-- Sidebar with Buttons -->
        <aside class="sidebar">
            <button class="sidebar-btn">
                <i class="fas fa-plus"></i>
                <span>Aggiungi sessioni</span>
            </button>

            <button class="sidebar-btn">
                <i class="fas fa-history"></i>
                <span>Storico Sessioni</span>
            </button>

            <button class="sidebar-btn">
                <i class="fas fa-dumbbell"></i>
                <span>Massimali</span>
            </button>

            <button class="sidebar-btn">
                <i class="fas fa-trophy"></i>
                <span>Sfide</span>
            </button>

            <button class="sidebar-btn">
                <i class="fas fa-calendar-alt"></i>
                <span>Sessione del Mese</span>
            </button>

            <!-- Divider -->
            <div class="sidebar-divider"></div>

            <!-- Profile, Settings, and Logout Buttons -->
            <a href="profile.html" class="sidebar-btn">
                <i class="fas fa-user-circle"></i>
                <span>Profilo</span>
            </a>

            <button class="sidebar-btn">
                <i class="fas fa-cog"></i>
                <span>Impostazioni</span>
            </button>

            <button class="sidebar-btn">
                <i class="fas fa-sign-out-alt"></i>
                <span>Logout</span>
            </button>
        </aside>

        <!-- Main Content Area -->
        <main class="main-content">
            <section class="profile-section" id="profile-section">
                <h2>Profilo Utente</h2>
                <div id="profile-info">
                    <p><strong>Nome:</strong> <span id="name">Caricamento...</span></p>
                    <p><strong>Email:</strong> <span id="email">Caricamento...</span></p>
                    <p><strong>Età:</strong> <span id="eta">Caricamento...</span></p>
                    <p><strong>Sesso</strong> <span id="sesso">Caricamento...</span></p>
                    <p><strong>Peso:</strong> <span id="peso">Caricamento...</span></p>
                </div>
                <button class="sidebar-btn" onclick="editProfile()">Modifica Profilo</button>
            </section>
        </main>
    </div>

    <div class="overlay" id="overlay"></div>

    <script>
        function toggleSidebar() {
            const sidebar = document.querySelector('.sidebar');
            const overlay = document.getElementById('overlay');
            const menuButton = document.getElementById('menuButton');

            sidebar.classList.toggle('active');
            overlay.classList.toggle('visible');

            if (sidebar.classList.contains('active')) {
                menuButton.innerHTML = '<i class="fas fa-times"></i>';
            } else {
                menuButton.innerHTML = '<i class="fas fa-bars"></i>';
            }
        }

        document.getElementById('overlay').addEventListener('click', () => {
            toggleSidebar();
        });
    </script>
</body>

</html>